<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Calibrate an ensemble Bayesian Model Averaging model</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for calibrateEnsemble {EBMAforecast}"><tr><td>calibrateEnsemble {EBMAforecast}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Calibrate an ensemble Bayesian Model Averaging model</h2>

<h3>Description</h3>

<p>This function calibrates an EBMA model based on out-of-sample performance in the calibration time period. Given a dependent variable and calibration-sample predictions from multiple component forecast models in the <code>ForecastData</code> the <code>calibrateEnsemble</code> function fits an ensemble BMA mixture model. The weights assigned to each model are derived from the individual model's performance in the calibration period. Missing observations are allowed in the calibration period, however models with missing observations are penalized. When missing observations are prevalent in the calibration set, the EM algorithm is adjusted and model paprameters are estimated by maximizing a renormalized partial expected complete-data log-likelihood (Fraley et al. 2010).
</p>


<h3>Usage</h3>

<pre>
calibrateEnsemble(.forecastData = new("ForecastData"), exp = 1,
  tol = sqrt(.Machine$double.eps), maxIter = 1e+06, model = "logit",
  method = "EM", ...)

fitEnsemble(.forecastData, tol = sqrt(.Machine$double.eps), maxIter = 1e+06,
  method = "EM", exp = 1, useModelParams = TRUE,
  predType = "posteriorMedian", const = 0, W = c(), ...)

## S4 method for signature 'ForecastDataNormal'
fitEnsemble(.forecastData,
  tol = sqrt(.Machine$double.eps), maxIter = 1e+06, method = "EM",
  exp = numeric(), useModelParams = TRUE, predType = "posteriorMedian",
  const = 0, W = c())
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>.forecastData</code></td>
<td>
<p>An object of class 'ForecastData' that will be used to calibrate the model.</p>
</td></tr>
<tr valign="top"><td><code>exp</code></td>
<td>
<p>The exponential shrinkage term.  Forecasts are raised to the (1/exp) power on the logit scale for the purposes of bias reduction.  The default value is <code>exp=3</code>.</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>Tolerance for improvements in the log-likelihood before the EM algorithm will stop optimization.  The default is <code>tol= 0.01</code>, which is somewhat high.  Researchers may wish to reduce this by an order of magnitude for final model estimation.</p>
</td></tr>
<tr valign="top"><td><code>maxIter</code></td>
<td>
<p>The maximum number of iterations the EM algorithm will run before stopping automatically. The default is <code>maxIter=10000</code>.</p>
</td></tr>
<tr valign="top"><td><code>model</code></td>
<td>
<p>The model type that should be used given the type of data that is being predicted (i.e., normal, binary, etc.).</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>The estimation method used.  Currently only implements &quot;EM&quot;.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Not implemented</p>
</td></tr>
<tr valign="top"><td><code>useModelParams</code></td>
<td>
<p>If &quot;TRUE&quot; individual model predictions are transformed based on logit models. If &quot;FALSE&quot; all models' parameters will be set to 0 and 1.</p>
</td></tr>
<tr valign="top"><td><code>predType</code></td>
<td>
<p>The prediction type used for the EBMA model under the normal model, user can choose either <code>posteriorMedian</code> or <code>posteriorMean</code>. Posterior median is the default.</p>
</td></tr>
<tr valign="top"><td><code>const</code></td>
<td>
<p>user provided &quot;wisdom of crowds&quot; parameter, serves as minimum model weight for all models. Default = 0</p>
</td></tr>
<tr valign="top"><td><code>W</code></td>
<td>
<p>Vector of initial model weights, if unspecified each model will receive weight 1/number of Models</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data of class 'FDatFitLogit' or FDatFitNormal, a subclass of 'ForecastData', with the following slots
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>predCalibration</code></td>
<td>
<p>A matrix containing the predictions of all component models and the EBMA model for all observations in the calibration period.</p>
</td></tr> 
<tr valign="top"><td><code>predTest</code></td>
<td>
<p>A matrix containing the predictions of all component models and the EBMA model for all observations in the test period.</p>
</td></tr>
<tr valign="top"><td><code>outcomeCalibration</code></td>
<td>
<p>A vector containing the true values of the dependent variable for all observations in the calibration period.</p>
</td></tr> 
<tr valign="top"><td><code>outcomeTest</code></td>
<td>
<p>An optional vector containing the true values of the dependent variable for all observations in the test period.</p>
</td></tr>
<tr valign="top"><td><code>modelNames</code></td>
<td>
<p>A character vector containing the names of all component models.  If no model names are specified, names will be assigned automatically.</p>
</td></tr>
<tr valign="top"><td><code>modelWeights</code></td>
<td>
<p>A vector containing the model weights assigned to each model.</p>
</td></tr>
<tr valign="top"><td><code>modelParams</code></td>
<td>
<p>The parameters for the individual logit models that transform the component models.</p>
</td></tr>
<tr valign="top"><td><code>useModelParams</code></td>
<td>
<p>Indicator whether model parameters for transformation were estimated or not.</p>
</td></tr>
<tr valign="top"><td><code>logLik</code></td>
<td>
<p>The final log-likelihood for the calibrated EBMA model.</p>
</td></tr>
<tr valign="top"><td><code>exp</code></td>
<td>
<p>The exponential shrinkage term.</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>Tolerance for improvements in the log-likelihood before the EM algorithm will stop optimization.</p>
</td></tr>
<tr valign="top"><td><code>maxIter</code></td>
<td>
<p>The maximum number of iterations the EM algorithm will run before stopping automatically.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>The estimation method used. </p>
</td></tr>
<tr valign="top"><td><code>iter</code></td>
<td>
<p>Number of iterations run in the EM algorithm.</p>
</td></tr>
<tr valign="top"><td><code>call</code></td>
<td>
<p>The actual call used to create the object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael D. Ward &lt;<a href="mailto:michael.d.ward@duke.edu">michael.d.ward@duke.edu</a>&gt; and Jacob M. Montgomery &lt;<a href="mailto:jacob.montgomery@wustl.edu">jacob.montgomery@wustl.edu</a>&gt; and Florian M. Hollenbach &lt;<a href="mailto:florian.hollenbach@tamu.edu">florian.hollenbach@tamu.edu</a>&gt;
</p>


<h3>References</h3>

<p>Montgomery, Jacob M., Florian M. Hollenbach and Michael D. Ward. (2015). Calibrating ensemble forecasting models with sparse data in the social sciences.   <em>International Journal of Forecasting</em>. In Press.
</p>
<p>Montgomery, Jacob M., Florian M. Hollenbach and Michael D. Ward. (2012). Improving Predictions Using Ensemble Bayesian Model Averaging. <em>Political Analysis</em>. <b>20</b>: 271-291.
</p>
<p>Raftery, A. E., T. Gneiting, F. Balabdaoui and M. Polakowski. (2005). Using Bayesian Model Averaging to calibrate forecast ensembles. <em>Monthly Weather Review</em>. <b>133</b>:1155&ndash;1174.
</p>
<p>Sloughter, J. M., A. E. Raftery, T. Gneiting and C. Fraley. (2007). Probabilistic quantitative precipitation forecasting using Bayesian model averaging. <em>Monthly Weather Review</em>. <b>135</b>:3209&ndash;3220.
</p>
<p>Fraley, C., A. E. Raftery, T. Gneiting. (2010). Calibrating Multi-Model Forecast Ensembles with Exchangeable and Missing Members using Bayesian Model Averaging. <em>Monthly Weather Review</em>. <b>138</b>:190&ndash;202.
</p>
<p>Sloughter, J. M., T. Gneiting and A. E. Raftery. (2010). Probabilistic wind speed forecasting using ensembles and Bayesian model averaging. <em>Journal of the American Statistical Association</em>. <b>105</b>:25&ndash;35.
</p>
<p>Fraley, C., A. E. Raftery, and T. Gneiting. (2010). Calibrating multimodel forecast ensembles with exchangeable and missing members using Bayesian model averaging. <em>Monthly Weather Review</em>. <b>138</b>:190&ndash;202.
</p>


<h3>Examples</h3>

<pre>
## Not run: data(calibrationSample)

data(testSample) 

this.ForecastData &lt;- makeForecastData(.predCalibration=calibrationSample[,c("LMER", "SAE", "GLM")],
.outcomeCalibration=calibrationSample[,"Insurgency"],.predTest=testSample[,c("LMER", "SAE", "GLM")],
.outcomeTest=testSample[,"Insurgency"], .modelNames=c("LMER", "SAE", "GLM"))

this.ensemble &lt;- calibrateEnsemble(this.ForecastData, model="logit", tol=0.001, exp=3)

## End(Not run)

</pre>

<hr /><div style="text-align: center;">[Package <em>EBMAforecast</em> version 0.52 <a href="00Index.html">Index</a>]</div>
</body></html>
